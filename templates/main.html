<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>main</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    function guessMoneyLimit() {
        const min = {{ minPrice }};
        const max = {{ maxPrice }};
        const value = parseInt(document.getElementById("user-input-money").value);

        if (isNaN(value) || value < min || value > max) {
            alert(`${min}ë¶€í„° ${max} ì‚¬ì´ì˜ ì •ìˆ˜ë§Œ ì…ë ¥í•´ì£¼ì„¸ìš”!`);
            return;
        }

    
        guessMoney();  
    }

    
    </script>
    <style>
    .level-0 { background-color: #ebedf0; }
    .level-1 { background-color: #c6e48b; }

</style>
</head>
<body class="min-h-screen bg-white flex flex-col items-center mt-40 text-gray-800 font-sans"> 
    <div class="w-full flex justify-end pr-20 mt-5 mb-10">
        <button onclick="logout()" class="bg-emerald-500 text-white px-4 py-2 rounded hover:bg-emerald-600 transition">
            ë¡œê·¸ì•„ì›ƒ
        </button>
    </div>

    <div class="flex flex-col items-center mb-5">
        <img src="https://contents.kyobobook.co.kr/sih/fit-in/458x0/pdt/9791163031727.jpg" class="w-40 mb-4" />
        <form>
        <input id="user-input-money" placeholder="{{ minPrice }}~{{ maxPrice }} ì…ë ¥ ê°€ëŠ¥" type="number"
        min=10 max=20 class="w-full px-2 py-3 border-b border-gray-400 focus:outline-none text-center text-gray-600 mb-4">
        <div class="flex space-x-2 mb-2">
            <button onclick=" guessMoneyLimit()" type="button" class="bg-emerald-500 text-white px-4 py-2 rounded">
                ë„ì „í•˜ê¸°
            </button>
        <button type="button" onclick="popupTicket()" class="border border-emerald-500 text-emerald-500 px-4 py-2 rounded">ë„ì „ê¶Œ ì–»ê¸°</button>
        </div>
        </form>
    </div>


    <div id="ticket-count">
        {% if appTicket %}
        ğŸ« ë³´ìœ  ë„ì „ê¶Œ : {{ appTicket }}ê°œ
        {% else %}
        ğŸ« ë³´ìœ  ë„ì „ê¶Œ : ì—†ìŒ
        {% endif %}
    </div>
    

    <button class="text-gray-700 underline hover:text-emerald-500 transition mb-4 mt-10"  onclick="toggle_record()">â†’ ë‚˜ì˜ ë„ì „ ê¸°ë¡ í™•ì¸í•˜ê¸°</button>
    <div id="past_record" class="hidden transition-all duration-300 flex flex-col items-center gap-4 mt-4 w-full max-w-md">
        <h2 class="text-xl font-semibold text-gray-800">ğŸ“œ ë‚˜ì˜ ë„ì „ ê¸°ë¡</h2>
        <ul class="space-y-2">
            {% for user in appList %}
            <li class="flex justify-between items-center bg-gray-100 px-4 py-3 rounded-lg shadow hover:shadow-md transition">
                <span class="text-emerald-600 font-medium">{{ user.appPrice }}ì›</span>
                <span class="text-sm text-gray-500">{{ user.appDate[:10] }} {{ user.appDate[11:16] }}</span>
            </li>
            {% endfor %}
        </ul>
    </div>
</div>


<div class="flex gap-40 mt-40 items-center">
    <div class="flex flex-col gap-10 text-center">
        {% if appList and appList[0].appDate %}
            <div class="label">
            {{ appList[0].appDate[:4] }}ë…„ {{ appList[0].appDate[5:7]|int }}ì›”
            </div>
        {% else %}
            <div class="label">ìµœê·¼ ì‘ëª¨ ê¸°ë¡ ì—†ìŒ</div>
        {% endif %}
        <div class="grid gap-3" style="grid-template-columns: repeat(7, 16px);" id="grassGrid">
            {% for day in days %}
            <div class="w-6 h-6 rounded-sm level-{{ day.level }}"
                data-date="{{ day.date }}">
            </div>
            {% endfor %}
        </div>
    {% if appList %}
    <p class="mt-10 text-sm text-gray-700">ì—°ì† ì‘ëª¨ íšŸìˆ˜ {{consecutiveDay}}íšŒ</p>
    {% else %}
    <p class="mt-10 text-sm text-gray-700">ì—°ì† ì‘ëª¨ íšŸìˆ˜ 0íšŒ</p>
    {% endif %}

    </div>
    <div class="flex flex-col gap-3 mb-5 text-center">
        <div class="text-9xl mt-7 mb-7" onclick="location.href='{{url_for('getRewards')}}'">ğŸ†</div>
        <p class="text-sm text-gray-700">ì§€ë‚œ ë„ì „ ë‹¹ì²¨ ê²°ê³¼ í™•ì¸</p>
    </div>
</div>

<div id="popup-user-record" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="flex flex-col justify-center bg-white p-6 rounded-xl shadow-lg w-[500px] h-[700px] text-center">
        <h2 class="text-[28px] font-semibold mb-5"><p class="text-4xl mb-4">ğŸ“¢</p>ê²°ê³¼ ë°œí‘œ</h2>
        <p class="mb-20">ì´ë²ˆ íšŒì°¨ ë°œí‘œ ì¼ì‹œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
        <div class="mb-20">25 / 07 / 08  12:00 </div>

        <div class="flex justify-center space-x-4">
            <button id="popup-cancel" onclick="popupSuccess()" class="text-white bg-emerald-500 border border-gray-300 text-gray-600 px-4 py-2 rounded">ëŒì•„ê°€ê¸°</button>
        </div>
    </div>
</div>

<div id="popup-user-fail" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden ">
    <div class="flex flex-col justify-center bg-white p-6 rounded-xl shadow-lg w-[500px] h-[700px] text-center">
        <div class="mb-20 mt-12 font-semibold text-xl"> ğŸ¥¹ ë³´ìœ í•˜ê³  ìˆëŠ” ë„ì „ê¶Œì´ ì—†ìŠµë‹ˆë‹¤ ã… ã…  </div>
        <div class="mb-[100px] font-semibold text-xl"> ğŸ”¥ ì»¤ë°‹í•˜ê³  ë„ì „ê¶Œ ì–»ìœ¼ëŸ¬ ê°€ê¸° ! </div>
        <div class="flex justify-center space-x-4">
            <button id="popup-cancel" onclick="popupfail()" class="text-white bg-emerald-500 border border-gray-300 text-gray-600 px-4 py-2 rounded mt-14">ëŒì•„ê°€ê¸°</button>
        </div>
    </div>
</div>

<div id="popup-ticket" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="flex flex-col justify-center items-center bg-white p-6 rounded-xl shadow-lg w-[500px] h-[700px] text-center">
        <h2 class="text-[28px] font-semibold mb-5"><p class="text-4xl mb-4">ğŸ”¥</p>ë„ì „ê¶Œ ì–»ê¸°</h2>
        <div class="flex flex-col gap-3 mt-12 w-[350px]" >
            <div class="flex items-center justify-between">
            <h2 class="text-[20px] translate-x-5">ë§¤ì¼ ë„ì „í•˜ê¸°
            </h2>
            <button onclick="addEveryDayTicket()" class="text-white bg-emerald-500 border border-gray-300 text-gray-600 px-4 py-2 rounded">ë„ì „ê¶Œ ì–»ê¸°</button>
            </div>
            <p id=everyCouponAlert class="w-full text-right opacity-0 pointer-events-none text-red-500 text-sm">ë”ì´ìƒ ë°›ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
            <div class="flex flex items-center justify-between">
            <h2 class="text-[20px]">ì»¤ë°‹í•˜ê³  ë„ì „í•˜ê¸°
            </h2>
            <button onclick="addCommitTicket()" class="text-white bg-emerald-500 border border-gray-300 text-gray-600 px-4 py-2 rounded">ë„ì „ê¶Œ ì–»ê¸°</button>
        </div>
        <p id=commitCouponAlert class="w-full text-right opacity-0 pointer-events-none text-red-500 text-sm">ë”ì´ìƒ ë°›ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
    </div>
        
    <div class="flex justify-center mt-24">
        <button id="popup-cancel" onclick="popupTicket()" class="text-white bg-emerald-500 border border-gray-300 text-gray-600 px-4 py-2 rounded">ëŒì•„ê°€ê¸°</button>
    </div>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script src="/static/js/main.js"></script>

</body>
</html>